.. contents:: Table of Contents

General
=======

**These settings can be on reverse proxy server or the application itself.**

- Put maximum limitation on everything.

  * Rate limiting
  * Turn off all un-used ports (both in and out).
  * Only give accounts minimal level of permission.
  * Run services as non-root user, non-root group.
  * ...

- Don't log sensitive information.
- Validate client's inputs.

  * SQL injection
  * ...

- Check CORS list.
- Check/Disable directory access.
- Enable HTTPS.
- Set HTTP limits.

  * KeepAlive=on
  * KeepAliveTimeout
  * LimitRequestBody
  * LimitRequestFields
  * LimitRequestFieldSize
  * LimitRequestLine
  * LimitXMLRequestBody
  * MaxClients
  * MaxKeepAliveRequests
  * MaxRequestWorkers
  * RequestReadTimeout
  * TimeOut

- Enable ``HttpOnly`` and ``Secure`` for cookies.

  * https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies

- Enable security-related headers [`ref <https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers#Security>`__].

  * `Content-Security-Policy (CSP) <https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy>`__
  * `Cross-Origin-Resource-Policy <https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Resource-Policy>`__
  * `Strict-Transport-Security (HSTS) <https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security>`__

HTTP Headers
------------

- Collect from https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Index

+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
| Both           | Request                              | Response                            | Example                                                             |
+================+======================================+=====================================+=====================================================================+
|                | Accept                               |                                     | Accept: text/html                                                   |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Accept-Charset                       |                                     | Accept-Charset: utf-8, iso-8859-1;q=0.5                             |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Accept-Encoding                      |                                     | Accept-Encoding: gzip                                               |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Accept-Language                      |                                     | Accept-Language: de                                                 |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Accept-Patch                         |                                     |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Accept-Ranges                        |                                     | Accept-Ranges: bytes                                                |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Access-Control-Allow-Credentials    | Access-Control-Allow-Credentials: true                              |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Access-Control-Allow-Headers        | Access-Control-Allow-Headers: X-Custom-Header                       |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Access-Control-Allow-Methods        | Access-Control-Allow-Methods: POST, GET, OPTIONS                    |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Access-Control-Allow-Origin         | Access-Control-Allow-Origin: *                                      |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Access-Control-Expose-Headers       | Access-Control-Expose-Headers: Content-Length, X-Kuma-Revision      |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Access-Control-Max-Age              | Access-Control-Max-Age: 600                                         |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Access-Control-Request-Headers       |                                     | Access-Control-Request-Headers: X-PINGOTHER, Content-Type           |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Access-Control-Request-Method        |                                     | Access-Control-Request-Method: POST                                 |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Age                                 | Age: 24                                                             |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Allow                               | Allow: GET, POST, HEAD                                              |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Authorization                        |                                     | Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l                       |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
| Cache-Control  | Cache-Control: max-age=<seconds>     | Cache-Control: must-revalidate      |                                                                     |
|                | Cache-Control: max-stale[=<seconds>] | Cache-Control: no-cache             |                                                                     |
|                | Cache-Control: min-fresh=<seconds>   | Cache-Control: no-store             |                                                                     |
|                | Cache-Control: no-cache              | Cache-Control: no-transform         |                                                                     |
|                | Cache-Control: no-store              | Cache-Control: public               |                                                                     |
|                | Cache-Control: no-transform          | Cache-Control: private              |                                                                     |
|                | Cache-Control: only-if-cached        | Cache-Control: proxy-revalidate     |                                                                     |
|                |                                      | Cache-Control: max-age=<seconds>    |                                                                     |
|                |                                      | Cache-Control: s-maxage=<seconds>   |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Clear-Site-Data                     | Clear-Site-Data: "cache", "cookies", "storage", "executionContexts" |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Connection                           |                                     | Connection: keep-alive Connection: close                            |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Content-Disposition                 |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Content-Encoding                    | Content-Encoding: gzip                                              |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Content-Language                    | Content-Language: de-DE                                             |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
| Content-Length |                                      |                                     |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Content-Location                    | Content-Location: /documents/foo.json                               |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Content-Range                       | Content-Range: bytes 200-1000/67589                                 |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Content-Security-Policy             |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Content-Security-Policy-Report-Only |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
| Content-Type   |                                      |                                     |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Cookie                               |                                     |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | DNT                                  |                                     | DNT: 0 DNT: 1                                                       |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
| Date           |                                      |                                     | Date: Wed, 21 Oct 2015 07:28:00 GMT                                 |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Etag                                | ETag: "33a64df551425fcc55e4d42a148795d9f25f89d4"                    |
|                |                                      |                                     | ETag: W/"0815"                                                      |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Expires                             | Expires: Wed, 21 Oct 2015 07:28:00 GMT                              |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Forwarded (added by reverse proxy)   |                                     |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Host                                 |                                     | Host: developer.cdn.mozilla.net                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | If-Match                             |                                     | If-Match: "67ab43", "54ed21", "7892dd"                              |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | If-Modified-Since                    |                                     | If-Modified-Since: Wed, 21 Oct 2015 07:28:00 GMT                    |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | If-None-Match                        |                                     | If-None-Match: W/"67ab43", "54ed21", "7892dd"                       |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | If-Range                             |                                     | If-Range: Wed, 21 Oct 2015 07:28:00 GMT                             |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | If-Unmodified-Since                  |                                     | If-Unmodified-Since: Wed, 21 Oct 2015 07:28:00 GMT                  |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Keep-Alive                          | Keep-Alive: timeout=5, max=1000                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Last-Modified                       | Last-Modified: Wed, 21 Oct 2015 07:28:00 GMT                        |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Location                            | Location: /index.html                                               |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Origin                               |                                     | Origin: https://developer.mozilla.org                               |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Proxy-Authenticate                  | Proxy-Authenticate: Basic                                           |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Proxy-Authorization                  |                                     | Proxy-Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l                 |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Range                                |                                     | Range: bytes=200-1000, 2000-6576, 19000-                            |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Referer                              |                                     | Referer: https://developer.mozilla.org/en-US/docs/Web/JavaScript    |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Referrer-Policy                     |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Retry-After                         | Retry-After: Wed, 21 Oct 2015 07:28:00 GMT Retry-After: 120         |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Sec-WebSocket-Accept                | Sec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=                  |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Server                              | Server: Apache/2.4.1 (Unix)                                         |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Server-Timing                       |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Set-Cookie                          |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | SourceMap                           | SourceMap: /path/to/file.js.map                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Strict-Transport-Security           |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | TE                                   |                                     | TE: compress                                                        |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Timing-Allow-Origin                 | Timing-Allow-Origin: https://developer.mozilla.org                  |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Tk                                  |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Trailer                              |                                     | Trailer: Expires                                                    |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | Upgrade-Insecure-Requests            |                                     |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                | User-Agent                           |                                     |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Vary                                | Vary: User-Agent                                                    |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | WWW-Authenticate                    | WWW-Authenticate: Basic                                             |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | Warning                             |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | X-Content-Type-Options              |                                                                     |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | X-DNS-Prefetch-Control              | X-DNS-Prefetch-Control: on                                          |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+
|                |                                      | X-Frame-Options                     | X-Frame-Options: deny X-Frame-Options: sameorigin                   |
+----------------+--------------------------------------+-------------------------------------+---------------------------------------------------------------------+

References
==========

- https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/index
